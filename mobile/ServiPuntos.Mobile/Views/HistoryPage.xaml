<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="ServiPuntos.Mobile.Views.HistoryPage"
    Title="Historial de Transacciones">

    <!-- El padding y el background se gestionan con el estilo global de Page -->
    <StackLayout Spacing="{StaticResource DefaultSpacing}">

        <!-- Mensaje cuando no hay transacciones -->
        <Label
            Text="No tienes transacciones aún."
            IsVisible="{Binding HasAny, Converter={StaticResource InverseBooleanConverter}}"
            Style="{StaticResource Caption}"/>

        <!-- Lista de transacciones -->
        <CollectionView
            ItemsSource="{Binding Transactions}"
            IsVisible="{Binding HasAny}"
            Margin="0,12,0,0">
            <!-- aquí usamos 12 en lugar de {StaticResource DefaultSpacing} -->

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <!-- Tarjeta genérica -->
                    <Frame Style="{StaticResource CardFrameStyle}">
                        <StackLayout Spacing="{StaticResource SmallSpacing}">
                            <!-- Fecha -->
                            <Label
                                Text="{Binding Fecha, StringFormat='{0:dd/MM/yyyy HH:mm}'}"
                                Style="{StaticResource Body}"/>

                            <!-- Tipo -->
                            <Label
                                Text="{Binding Tipo}"
                                Style="{StaticResource Body}"/>

                            <!-- Monto -->
                            <Label
                                Text="{Binding Monto, StringFormat='Monto: {0:C}'}"
                                Style="{StaticResource Body}"/>

                            <!-- Puntos otorgados -->
                            <Label
                                Text="{Binding PuntosOtorgados, StringFormat='Puntos: {0}'}"
                                Style="{StaticResource Body}"/>
                        </StackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Botón “Cargar más” -->
        <Button
            Text="Cargar más"
            Command="{Binding LoadMoreCommand}"
            IsVisible="{Binding HasMore}"
            Style="{StaticResource PrimaryButtonStyle}"/>

        <!-- Spinner centrado -->
        <ActivityIndicator
            IsRunning="{Binding IsBusy}"
            IsVisible="{Binding IsBusy}"
            Style="{StaticResource CenteredIndicatorStyle}"/>

    </StackLayout>
</ContentPage>
