<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="ServiPuntos.Mobile.Views.OffersPage"
    Title="Ofertas Flash">

    <!-- Spacing global desde Styles.xaml -->
    <StackLayout Spacing="{StaticResource DefaultSpacing}">

        <!-- Lista de ofertas -->
        <CollectionView
            ItemsSource="{Binding Offers}"
            ItemsLayout="VerticalList"
            Margin="0,0,0,12">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <!-- Card reutilizable -->
                    <Frame Style="{StaticResource CardFrameStyle}">
                        <StackLayout Spacing="{StaticResource SmallSpacing}">
                            <!-- Título -->
                            <Label
                                Text="{Binding Titulo}"
                                Style="{StaticResource HeadlineLabelStyle}"/>

                            <!-- Descripción -->
                            <Label
                                Text="{Binding Descripcion}"
                                Style="{StaticResource Body}"/>

                            <!-- Precio en puntos -->
                            <Label
                                Text="{Binding PrecioEnPuntos, StringFormat='{0} pts'}"
                                Style="{StaticResource Caption}">
                                <Label.Triggers>
                                    <DataTrigger
                                        TargetType="Label"
                                        Binding="{Binding PrecioEnPuntos}"
                                        Value="{x:Null}">
                                        <Setter Property="IsVisible"
                                                Value="False"/>
                                    </DataTrigger>
                                </Label.Triggers>
                            </Label>

                            <!-- Precio en pesos -->
                            <Label
                                Text="{Binding PrecioEnPesos, StringFormat='${0:F2}'}"
                                Style="{StaticResource Caption}">
                                <Label.Triggers>
                                    <DataTrigger
                                        TargetType="Label"
                                        Binding="{Binding PrecioEnPesos}"
                                        Value="{x:Null}">
                                        <Setter Property="IsVisible"
                                                Value="False"/>
                                    </DataTrigger>
                                </Label.Triggers>
                            </Label>

                            <!-- Descuento -->
                            <Label
                                Text="{Binding DescuentoEnPesos, StringFormat='Descuento: ${0:F2}'}"
                                Style="{StaticResource Caption}">
                                <Label.Triggers>
                                    <DataTrigger
                                        TargetType="Label"
                                        Binding="{Binding DescuentoEnPesos}"
                                        Value="{x:Null}">
                                        <Setter Property="IsVisible"
                                                Value="False"/>
                                    </DataTrigger>
                                </Label.Triggers>
                            </Label>
                        </StackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Botón de refrescar -->
        <Button
            Text="Actualizar"
            Command="{Binding RefreshCommand}"
            Style="{StaticResource PrimaryButtonStyle}"/>

        <!-- Indicador de actividad -->
        <ActivityIndicator
            IsRunning="{Binding IsBusy}"
            IsVisible="{Binding IsBusy}"
            Style="{StaticResource CenteredIndicatorStyle}"/>

    </StackLayout>
</ContentPage>
